<!doctype html>
<html lang="en" class="h-full">

<head>
  {{ partial "head.html" . }}
</head>

<body class="min-h-full bg-white text-slate-900 dark:bg-slate-950 dark:text-slate-100">
  <div class="mx-auto max-w-3xl px-4 sm:px-6 lg:max-w-6xl">
    {{ partial "header.html" . }}
    <main id="main" class="py-10">
      {{ block "main" . }}{{ end }}
    </main>
    {{ partial "footer.html" . }}
  </div>
  <script>
    // Theme toggle: sync aria-pressed; icons switch via CSS (dark: classes)
    (function () {
      var btn = document.getElementById('theme-toggle');
      if (!btn) return;
      function syncState() {
        var isDark = document.documentElement.classList.contains('dark');
        btn.setAttribute('aria-pressed', isDark ? 'true' : 'false');
      }
      syncState();
      btn.addEventListener('click', function () {
        var isDark = document.documentElement.classList.toggle('dark');
        try { localStorage.setItem('theme', isDark ? 'dark' : 'light'); } catch (e) { }
        syncState();
      });
    })();

    // Mobile menu toggle
    (function () {
      var toggle = document.getElementById('mobile-menu-toggle');
      var menu = document.getElementById('mobile-menu');
      if (!toggle || !menu) return;
      toggle.addEventListener('click', function () {
        var isHidden = menu.classList.toggle('hidden');
        toggle.setAttribute('aria-expanded', isHidden ? 'false' : 'true');
      });
    })();
  </script>
  <script>
    // Prefetch nav targets on first intent (hover/focus)
    (function () {
      try {
        var supports = 'relList' in HTMLLinkElement.prototype && HTMLLinkElement.prototype.relList.supports && HTMLLinkElement.prototype.relList.supports('prefetch');
        if (!supports) return;
      } catch (e) { return; }
      var seen = new Set();
      function add(href) {
        if (seen.has(href) || href.indexOf('#') > -1 || href.startsWith('mailto:')) return;
        seen.add(href);
        var l = document.createElement('link');
        l.rel = 'prefetch';
        l.href = href;
        l.as = 'document';
        document.head.appendChild(l);
      }
      function bind(a) {
        var href = a.getAttribute('href');
        if (!href || href.charAt(0) !== '/') return;
        var h = function () { add(href); };
        a.addEventListener('pointerenter', h, { once: true });
        a.addEventListener('focus', h, { once: true });
      }
      document.querySelectorAll('nav a[href]').forEach(bind);
    })();
  </script>
</body>

</html>