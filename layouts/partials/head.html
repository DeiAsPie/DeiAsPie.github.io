{{/* Copied from theme's head.html and extended: hardened CSP rollout */}} {{
partial "style" (dict "path" "gen/tailwind.css") }} {{ partial "script"
(dict "path" "js/init-theme.js") }} {{ $styleSources := "'self'" }} {{
$fontSources := "'self'" }} {{ if .Site.Params.googleFonts }} {{ $styleSources
= printf "%s %s" $styleSources "https://fonts.googleapis.com" }} {{
$fontSources = printf "%s %s" $fontSources "https://fonts.gstatic.com" }} {{
end }} {{ $csp := printf "default-src 'self'; script-src 'self'; style-src %s; img-src 'self' data: https:; font-src %s; connect-src 'self'; frame-ancestors 'none'; report-to csp-endpoint" $styleSources $fontSources }}
<meta http-equiv="Content-Security-Policy" content="{{ $csp }}" />

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>{{ if .Title }}{{ .Title }} | {{ end }}{{ .Site.Title }}</title>
{{ $desc := "" }} {{ with .Params.description }}{{ $desc = . | plainify |
htmlEscape }}{{ end }} {{ if and (eq $desc "") (.Params.summary) }}{{ $desc =
(.Params.summary | plainify | htmlEscape) }}{{ end }} {{ if and (eq $desc "")
(.Summary) }}{{ $desc = (.Summary | plainify | htmlEscape) }}{{ end }} {{ if and
(eq $desc "") (.Site.Params.description) }}{{ $desc = (.Site.Params.description
| plainify | htmlEscape) }}{{ end }} {{ if eq $desc "" }}{{ $desc = (.Site.Title
| plainify | htmlEscape) }}{{ end }}
<meta name="description" content="{{ $desc }}" />
<meta name="author" content="{{ .Site.Params.author }}" />
<link rel="canonical" href="{{ .Permalink }}" />
<link rel="icon" href='{{ "/favicon.svg" | relURL }}' type="image/svg+xml" />
<link rel="apple-touch-icon" href='{{ "/favicon.svg" | relURL }}' />
<meta name="theme-color" content="#0f172a" />

{{ $absURL := .Permalink }}
<meta
  property="og:type"
  content="{{ if .IsPage }}article{{ else }}website{{ end }}"
/>
<meta property="og:url" content="{{ $absURL }}" />
<meta
  property="og:title"
  content="{{ if .Title }}{{ .Title }} | {{ end }}{{ .Site.Title }}"
/>
<meta property="og:description" content="{{ $desc }}" />
<meta property="og:site_name" content="{{ .Site.Title }}" />
{{ $ogimg := "" }} {{ if .Params.image }} {{ if or (hasPrefix .Params.image
"http://") (hasPrefix .Params.image "https://") }} {{ $ogimg = .Params.image }}
{{ else }} {{ $ogimg = (.Params.image | absURL) }} {{ end }} {{ else }} {{ $res
:= .Resources.ByType "image" }} {{ with first 1 $res }} {{ $first := index . 0
}} {{ $ogimg = ($first.Permalink) }} {{ else }} {{ $ogimg = ("/favicon.svg" |
absURL) }} {{ end }} {{ end }}
<meta property="og:image" content="{{ $ogimg }}" />
<meta name="twitter:card" content="summary_large_image" />
<meta
  name="twitter:title"
  content="{{ if .Title }}{{ .Title }} | {{ end }}{{ .Site.Title }}"
/>
<meta name="twitter:description" content="{{ $desc }}" />
<meta name="twitter:image" content="{{ $ogimg }}" />
<link
  rel="alternate"
  type="application/rss+xml"
  href="{{ .Site.BaseURL }}index.xml"
  title="RSS"
/>
<link rel="manifest" href="/manifest.json" />
{{ partial "fonts.html" . }} {{ if .IsHome }} {{ with .Site.Params.prefetch }}
{{ $current := $.RelPermalink }} {{ range . }} {{ if ne . $current }}
<link rel="prefetch" href="{{ . | relURL }}" as="document" />
{{ end }} {{ end }} {{ end }} {{ end }} {{ if and (not .IsHome) (not .IsNode) }}
{{ partial "seo-jsonld.html" . }} {{ else if .IsPage }} {{ partial
"seo-jsonld.html" . }} {{ end }}
