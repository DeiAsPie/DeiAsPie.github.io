{{/* Copied from theme's head.html and extended: switch CSP to report-only
rollout */}} {{ $styles := resources.Get "gen/tailwind.css" }} {{ if not
hugo.IsServer }} {{ $styles = $styles | minify | fingerprint }} {{ end }} {{
$initTheme := resources.Get "js/init-theme.js" }}{{ if not hugo.IsServer }}{{
$initTheme = $initTheme | minify | fingerprint }}{{ end }}
<script
  src="{{ $initTheme.RelPermalink }}"
  integrity="{{ with $initTheme.Data.Integrity }}{{ . }}{{ end }}"
></script>
{{/* Report-Only CSP to audit first; keep allowances for inline for now */}}
<meta
  http-equiv="Content-Security-Policy"
  content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; font-src 'self'; connect-src 'self' https:; frame-ancestors 'none'; report-to csp-endpoint"
/>

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>{{ if .Title }}{{ .Title }} | {{ end }}{{ .Site.Title }}</title>
{{ $desc := "" }} {{ with .Params.description }}{{ $desc = . | plainify |
htmlEscape }}{{ end }} {{ if and (eq $desc "") (.Params.summary) }}{{ $desc =
(.Params.summary | plainify | htmlEscape) }}{{ end }} {{ if and (eq $desc "")
(.Summary) }}{{ $desc = (.Summary | plainify | htmlEscape) }}{{ end }} {{ if and
(eq $desc "") (.Site.Params.description) }}{{ $desc = (.Site.Params.description
| plainify | htmlEscape) }}{{ end }} {{ if eq $desc "" }}{{ $desc = (.Site.Title
| plainify | htmlEscape) }}{{ end }}
<meta name="description" content="{{ $desc }}" />
<meta name="author" content="{{ .Site.Params.author }}" />
<link rel="canonical" href="{{ .Permalink }}" />
<link rel="icon" href='{{ "/favicon.svg" | relURL }}' type="image/svg+xml" />
<link rel="apple-touch-icon" href='{{ "/favicon.svg" | relURL }}' />
<meta name="theme-color" content="#0f172a" />

{{ $absURL := .Permalink }}
<meta
  property="og:type"
  content="{{ if .IsPage }}article{{ else }}website{{ end }}"
/>
<meta property="og:url" content="{{ $absURL }}" />
<meta
  property="og:title"
  content="{{ if .Title }}{{ .Title }} | {{ end }}{{ .Site.Title }}"
/>
<meta property="og:description" content="{{ $desc }}" />
<meta property="og:site_name" content="{{ .Site.Title }}" />
{{ $ogimg := "" }} {{ if .Params.image }} {{ if or (hasPrefix .Params.image
"http://") (hasPrefix .Params.image "https://") }} {{ $ogimg = .Params.image }}
{{ else }} {{ $ogimg = (.Params.image | absURL) }} {{ end }} {{ else }} {{ $res
:= .Resources.ByType "image" }} {{ with first 1 $res }} {{ $first := index . 0
}} {{ $ogimg = ($first.Permalink) }} {{ else }} {{ $ogimg = ("/favicon.svg" |
absURL) }} {{ end }} {{ end }}
<meta property="og:image" content="{{ $ogimg }}" />
<meta name="twitter:card" content="summary_large_image" />
<meta
  name="twitter:title"
  content="{{ if .Title }}{{ .Title }} | {{ end }}{{ .Site.Title }}"
/>
<meta name="twitter:description" content="{{ $desc }}" />
<meta name="twitter:image" content="{{ $ogimg }}" />
<link
  rel="alternate"
  type="application/rss+xml"
  href="{{ .Site.BaseURL }}index.xml"
  title="RSS"
/>
<link rel="manifest" href="/manifest.json" />
{{ partial "fonts.html" . }} {{ if .IsHome }} {{ with .Site.Params.prefetch }}
{{ $current := $.RelPermalink }} {{ range . }} {{ if ne . $current }}
<link rel="prefetch" href="{{ . | relURL }}" as="document" />
{{ end }} {{ end }} {{ end }} {{ end }}
<link
  rel="stylesheet"
  href="{{ $styles.RelPermalink }}"
  integrity="{{ with $styles.Data.Integrity }}{{ . }}{{ end }}"
/>
{{ if and (not .IsHome) (not .IsNode) }} {{ partial "seo-jsonld.html" . }} {{
else if .IsPage }} {{ partial "seo-jsonld.html" . }} {{ end }}
