---
title: "feat: Integrate Commitizen for Guided Conventional Commits"
type: feat
status: active
date: 2026-03-01
origin: docs/brainstorms/2026-03-01-commitizen-integration-brainstorm.md
---

# feat: Integrate Commitizen for Guided Conventional Commits

## Overview

This plan outlines the integration of **Commitizen (cz-cli)** and the **cz-conventional-changelog** adapter into the repository. This will provide a guided, interactive command-line interface for creating commit messages that strictly adhere to the [Conventional Commits](https://www.conventionalcommits.org/) specification. This integration directly addresses recurring `commitlint` errors (specifically `subject-case`) and establishes a foundation for automated changelog generation and releases.

(see brainstorm: docs/brainstorms/2026-03-01-commitizen-integration-brainstorm.md)

## Problem Statement / Motivation

The project currently enforces strict Conventional Commit rules via `commitlint` and `husky`. However, manual creation of these messages is prone to errors, such as using sentence-case for the subject (e.g., `feat: Add feature` instead of `feat: add feature`), which leads to failed commit attempts and developer friction. 

By providing a guided prompt, we remove the need for developers to memorize these rules and ensure that every commit message is correctly formatted from the start.

## Proposed Solution

1. **Install and Configure Commitizen**: Add `commitizen` and `cz-conventional-changelog` to `devDependencies`.
2. **Add Commit Script**: Define a `npm run commit` script that triggers the `cz` interactive prompt.
3. **Configure Adapter**: Set up the `config.commitizen` field in `package.json` to use the `cz-conventional-changelog` adapter.
4. **Refine Lint-staged**: Ensure the `pre-commit` hook (via `lint-staged`) handles the `scripts/` directory correctly, especially after the recent resolution of a global ignore conflict.

## Technical Considerations

### Commitizen Configuration

- **Adapter**: Using `cz-conventional-changelog` to match the project's `@commitlint/config-conventional` rules.
- **Strictness**: We can further customize the adapter's behavior (like hiding optional fields) via the `config.commitizen` block in `package.json` or a dedicated `.czrc` file to ensure the most streamlined developer experience.
- **Husky Integration**: The existing `commit-msg` hook remains the source of truth, ensuring that even commits made via the standard `git commit` command are still validated.

### Lint-staged 'Ignored Path' Fix

- **The Problem**: Friction occurs when `lint-staged` attempts to run tools on files that are staged but also git-ignored (e.g., within `docs/` or `scripts/`).
- **The Solution**: Modern `lint-staged` (v10+) handles re-staging automatically. To prevent "ignored path" errors from tools like ESLint or Prettier, we should ensure that our `lint-staged` patterns are precise or that we use a `lint-staged.config.js` with a filter function to only pass non-ignored files to the linting tools. (see research: docs/plans/2026-03-01-feat-integrate-commitizen-plan.md)

## System-Wide Impact

- **Interaction graph**: Running `npm run commit` triggers `cz`, which prompts for input, generates a message, and then triggers the `pre-commit` (lint-staged) and `commit-msg` (commitlint) hooks via Husky.
- **Error propagation**: If `lint-staged` fails (e.g., due to linting errors), the commit process is aborted before the `commit-msg` hook or the actual commit occurs.
- **State lifecycle risks**: Partial failure in the `cz` prompt (e.g., `Ctrl+C`) simply aborts the command without affecting the git state or staging area.
- **API surface parity**: All developers will be encouraged to use `npm run commit`, though standard `git commit` remains available (and will still be validated by `commitlint`).

## Acceptance Criteria

- [ ] `commitizen` and `cz-conventional-changelog` are present in `package.json` `devDependencies`.
- [ ] `npm run commit` successfully launches the interactive Commitizen prompt.
- [ ] Commit messages generated by the prompt pass `commitlint` validation (especially the `lower-case` subject rule).
- [ ] The `config.commitizen.path` in `package.json` is correctly set to `./node_modules/cz-conventional-changelog`.
- [ ] `lint-staged` correctly processes files in the `scripts/` directory during the commit flow without "ignored path" errors.
- [ ] Deleting or modifying files in `scripts/` does not trigger "ignored path" errors in the `pre-commit` hook. (see SpecFlow: docs/plans/2026-03-01-feat-integrate-commitizen-plan.md)

## Success Metrics

- 100% of commits generated via `npm run commit` pass the `commit-msg` hook on the first attempt.
- Reduced developer friction related to Conventional Commit formatting errors.

## Dependencies & Risks

- **Dependency**: Requires `npm install` to be successful (handling potential `node_modules` cache or permissions issues).
- **Risk**: If the `scripts/` folder continues to hit "ignored" errors on some environments, we may need to transition to a `lint-staged.config.js` to implement more robust file filtering. (see research: docs/plans/2026-03-01-feat-integrate-commitizen-plan.md)

## Sources & References

- **Origin brainstorm:** [docs/brainstorms/2026-03-01-commitizen-integration-brainstorm.md](docs/brainstorms/2026-03-01-commitizen-integration-brainstorm.md) â€” Carried forward: Standard adapter choice, use of `npm run commit` script, and handling of `scripts/` folder friction.
- Existing patterns: `package.json` (lint-staged), `commitlint.config.js` (rules).
- [Commitizen Documentation](https://github.com/commitizen/cz-cli)
- [Conventional Commits Specification](https://www.conventionalcommits.org/en/v1.0.0/)

## Implementation Steps (Mock filenames)

### package.json (update)

```json
{
  "scripts": {
    "commit": "cz"
  },
  "devDependencies": {
    "commitizen": "^4.3.1",
    "cz-conventional-changelog": "^3.3.0"
  },
  "config": {
    "commitizen": {
      "path": "./node_modules/cz-conventional-changelog"
    }
  }
}
```
